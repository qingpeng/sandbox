#!/usr/local/bin/perl -w
# programmer: zhangqp
# e-mail:zhangqp@genomics.org.cn
# 整合 cds_pos_genome信息
# refGene.txt中有的，优先用
# 没有的，用通过gbk文件以及gene_exon.list 生成的信息
# 2004-11-18 14:12
# 

if (@ARGV<3) {
	print  "programm refGene.txt cds_in_genome.pos file_out \n";
	exit;
}
($file_refgene,$file_in,$file_out) =@ARGV;

open IN,"$file_in" || die"$!";
open OUT,">$file_out" || die"$!";
open REFGENE,"$file_refgene" || die"$!";


# NM_024796	chr1	-	801449	802749	801942	802434	1	801449,	802749,
# NM_017891	chr1	-	923262	957529	924330	932981	10	923262,925790,925918,927315,928576,928939,931790,932909,933428,957497,	924425,925821,925944,927450,928642,929035,931866,933003,933541,957529,
# NM_153254	chr1	+	1021134	1027299	1021491	1026580	9	1021134,1021471,1021920,1022168,1023178,1023798,1024313,1025357,1026406,	1021291,1021778,1022039,1022298,1023253,1023884,1024485,1025529,1027299,
# NM_004195	chr1	-	1044946	1048147	1045281	1048009	5	1044946,1045471,1045836,1046807,1047822,	1045406,1045674,1045924,1046930,1048147,
# NM_148901	chr1	-	1044946	1048147	1045028	1048009	4	1044946,1045836,1046807,1047822,	1045398,1045924,1046930,1048147,
# NM_148902	chr1	-	1044946	1048147	1045281	1048009	5	1044946,1045492,1045836,1046807,1047822,	1045406,1045674,1045924,1046930,1048147,

while (<REFGENE>) {
	chomp;
	@s = split /\t/,$_;
	$orf_left{$s[0]} = $s[5]+1;
	$orf_right{$s[0]} = $s[6];
	$chr{$s[0]} = $s[1];
}


# X57025	chr12	101376622	
# X60188	chr16	30165317	
# X77166	chr20	44826750	44826944
# Z70723	chr7	94540438	
# NM_000776	chr7	98967169	98993135
# NM_004353	chr11	75003746	75009485
# NM_006220	chr14	92820093	
# NM_015858	chr1	21888402	2188857

while (<IN>) {
	chomp;
	@s = split /\t/,$_;
	if (exists $orf_left{$s[0]}) {
		print OUT "$s[0]\t$chr{$s[0]}\t$orf_left{$s[0]}\t$orf_right{$s[0]}\n";
	}
	else {
		print OUT "$_\n";
	}
}


